% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cobra_functions.R
\name{BatchCorrect}
\alias{BatchCorrect}
\title{BatchCorrect}
\usage{
BatchCorrect(
  data.mat,
  meta.mat,
  batch.var = "batch",
  cell.var = NULL,
  coi.var = NULL,
  stratify = FALSE,
  reduce = FALSE,
  sparse.tol = 1e-06
)
}
\arguments{
\item{data.mat}{A matrix of expression data, typically `cells x genes`.}

\item{meta.mat}{A data.frame containing at least one column for batch (and optionally cell type).}

\item{batch.var}{A string specifying the batch column in \code{meta.mat}.}

\item{cell.var}{A string specifying the cell type column in \code{meta.mat}, or \code{NULL} if unknown.}

\item{coi.var}{A vector of additional covariate column names in \code{meta.mat}.}

\item{stratify}{Logical. Whether to stratify batch effect correction by cell type.
Default \code{FALSE}.}

\item{reduce}{Logical. If \code{TRUE}, modifies the input orientation for memory usage.
Default \code{FALSE}.}

\item{sparse.tol}{Numeric tolerance for zeroing near-zero values, if used. Default \code{1e-6}.}
}
\value{
- If \code{cell.var} is provided, returns an adjusted expression matrix.
  - If \code{cell.var} is \code{NULL}, returns a list with \code{list(adj, pseudocell=...)}.
}
\description{
Adjusts for batch effects in single-cell RNA-seq data using an orthogonal
projection approach. Can also estimate pseudo-cells if cell types are not provided.
}
\examples{
\dontrun{
  # Suppose data.mat is your count matrix (cells x genes),
  # and meta.mat has columns "batch" and "CellType"
  corrected <- BatchCorrect(data.mat, meta.mat, batch.var="batch", cell.var="CellType")
}
}
